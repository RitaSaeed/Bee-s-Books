<!DOCTYPE html>
<html data-bs-theme="light" lang="en" data-bss-forced-theme="light">

<head>
    <meta charset="utf-8">
<title>Bee's Books</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>BeesBooksSprintTwo</title>
    <meta name="description" content="Online e-commerce store for books, developed by students in their senior year software engineering course at Radford University.">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="180x180" href="assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="assets/img/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/img/android-chrome-512x512.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/Inter.css">
    <link rel="stylesheet" href="assets/css/Libre%20Franklin.css">
    <link rel="stylesheet" href="assets/css/Raleway.css">
    <link rel="stylesheet" href="assets/css/Roboto.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="assets/css/Back-To-Top.css">
    <link rel="stylesheet" href="assets/css/Bootstrap-DataTables.css">
    <link rel="stylesheet" href="assets/css/Bootstrap-Payment-Form-.css">
    <link rel="stylesheet" href="assets/css/bs-theme-overrides.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css">
    <link rel="stylesheet" href="assets/css/Card-with-slide-up-text-effect.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-1.13.8/b-2.4.2/datatables.min.css">
    <link rel="stylesheet" href="assets/css/Navbar-Centered-Brand-icons.css">
    <link rel="stylesheet" href="assets/css/Responsive-Product-Slider.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="assets/css/menu-collapse-ultimate.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/6.0.1/css/tabulator.min.css" integrity="sha512-lYViaxM+7FHlHtQbmis/zPPWu+U+7AedEpiI1Jge4bhou50w1PxIokRz26zX4D3Jb9bEnaN9+mwDnjMKwFxqsg==" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/6.0.1/js/tabulator.min.js" integrity="sha512-G8zWCXA5j7VW/AF0D8Fl1/U5SXVRvTW2KBd0ykbziOocVu7yITccB+iV47uIROE1GXXbxL3dLPn8iqSF3KQLiQ==" crossorigin="anonymous"></script>
</head>

<body style="background:#E6E6FA;">
    <div id="promo-carousel" style="height:35px;background:var(--bs-primary-text-emphasis);">
        <div class="carousel slide d-xxl-flex align-items-xxl-center" data-bs-ride="carousel" data-bs-interval="7500" id="carousel-1" style="height:inherit;padding:0px 0px;padding-bottom:0px;margin-bottom:0px;">
            <div class="carousel-inner" style="height:inherit;position:absolute;">
                <div class="carousel-item active">
                    <p class="text-uppercase justify-content-xxl-center" id="promo-codes-carousel" style="text-align:center;padding:5px;height:inherit;font-weight:bold;color:#FFFFFF;width:auto;margin-bottom:0px;">Free shipping on orders over $50, code SHIP50 at checkout</p>
                </div>
                <div class="carousel-item">
                    <p class="text-uppercase" id="promo-codes-carousel-2" style="text-align:center;padding:5px;height:35px;margin-bottom:0px;color:#FFFFFF;font-weight:bold;">Buy one, get one 50% off horror titles during October, code SPOOKYSZN at checkout</p>
                </div>
                <div class="carousel-item">
                    <p class="text-uppercase" id="promo-codes-carousel-1" style="text-align:center;padding:5px;height:35px;margin-bottom:0px;font-weight:bold;color:#FFFFFF;">Free Bee's Books bookmark when purchasing 3 books or more</p>
                </div>
            </div>
            <div>
                <!-- Start: Previous --><a class="carousel-control-prev" href="#carousel-1" role="button" data-bs-slide="prev"><span style="height:25px;"></span><span class="visually-hidden">Previous</span></a><!-- End: Previous -->
                <!-- Start: Next --><a class="carousel-control-next" href="#carousel-1" role="button" data-bs-slide="next"><span style="height:25px;"></span><span class="visually-hidden">Next</span></a><!-- End: Next -->
            </div>
        </div>
    </div><!-- Start: Navbar Centered Links -->
    <nav class="navbar navbar-expand-md sticky-top bg-body bg-gradient py-3" id="main-navbar" style="box-shadow: 0px 0px 5px;">
        <div class="container-fluid"><script>
    window.addEventListener('load', function() {
        if (getCookie('access_token') != null) {
                //const username = getValueFromJWT('access_token', 'username');  
                setValueToElement("home-user-1", getValueFromJWT('access_token', 'username'));
                updateHref('home-user-1', "https://main.dva0ia48yehl5.amplifyapp.com/accountPage");
                const logoutLink = document.querySelector('#logout-link');
                logoutLink.style.display = 'inline-block';
                
        }
    });
    window.addEventListener('load', async function() {
       const isAdmin = await checkAdminStatus();
            if (isAdmin) {
                const adminLink = document.querySelector('#admin-link');
                adminLink.style.display = 'inline-block';
            } 
    });
    
    async function checkAdminStatus() {
            try {
                const accessToken = getCookie('id_token');
                const username = getValueFromJWT('access_token', "username")
                const response = await fetch("https://oevgdgxf8f.execute-api.us-east-1.amazonaws.com/beta/user?user=" + username, {
                    headers: {
                        Authorization: `${accessToken}`,
                    },
                });

                const data = await response.json();
                return data.isAdmin;

            } catch (error) {
                console.log("Not logged in.");
            }
    }


</script><a class="navbar-brand d-flex align-items-center" id="navbar-logo" href="index.html" style="margin-left: 30px;"><span class="bs-icon-sm bs-icon-circle bs-icon-primary shadow d-flex justify-content-center align-items-center me-2 bs-icon" style="width: 40px;height: 40px;background: #7C83BC;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" style="width: 25px;height: 25px;">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.9513 15.571C17.7695 17.2187 16.9205 18.6654 15.6805 19.635C15.332 20.4692 14.7092 21.1601 13.9247 21.5951C13.7025 22.4574 12.9196 23.0944 11.9879 23.0944C11.0562 23.0944 10.2733 22.4574 10.0511 21.5951C9.26672 21.1602 8.64392 20.4693 8.29547 19.6353C7.05955 18.6691 6.21203 17.229 6.02621 15.5883C4.93527 16.4161 3.37955 16.4118 2.28618 15.4944C1.01696 14.4294 0.851409 12.5371 1.91641 11.2679L6.00966 6.38975C6.27125 3.31753 8.84785 0.905579 11.9878 0.905579C15.1166 0.905579 17.6861 3.30046 17.9631 6.35711L22.0837 11.2679C23.1487 12.5371 22.9831 14.4294 21.7139 15.4944C20.613 16.4182 19.0433 16.4161 17.9513 15.571ZM15.6254 12.9056L13.9472 10.9056H10.0529L8.37467 12.9056H15.6254ZM17.9878 12.6095L19.0195 13.839C19.3745 14.2621 20.0053 14.3173 20.4283 13.9623C20.8514 13.6073 20.9066 12.9765 20.5516 12.5535L17.9878 9.49803V12.6095ZM15.9878 8.90558V6.90558C15.9878 4.69644 14.1969 2.90558 11.9878 2.90558C9.77865 2.90558 7.98779 4.69644 7.98779 6.90558V8.90558H15.9878ZM4.98059 13.839L5.98779 12.6387V9.52726L3.4485 12.5535C3.0935 12.9765 3.14869 13.6073 3.57176 13.9623C3.99483 14.3173 4.62559 14.2621 4.98059 13.839ZM11.9878 18.9056C9.77865 18.9056 7.98779 17.1147 7.98779 14.9056H15.9878C15.9878 17.1147 14.1969 18.9056 11.9878 18.9056Z" fill="currentColor"></path>
                    </svg></span><span style="font-weight: bold;color: var(--bs-emphasis-color);text-shadow: 0px 0px 5px var(--bs-primary-text-emphasis);">Bee's Books</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-3"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-3">
                <ul class="navbar-nav me-auto" style="margin-left: 50px;">
                    <li class="nav-item d-flex d-xxl-flex justify-content-center align-items-center justify-content-xxl-center align-items-xxl-center" style="margin-right: 0px;">
                        <div class="nav-item dropdown d-flex" style="border-radius: 25px;background: #7C83BC;margin: 0.5rem;position: relative;border-style: solid;border-color: #7C83BC;margin-right: -5px;width: 52px;"><a class="active d-flex d-sm-flex d-md-flex d-lg-flex d-xl-flex d-xxl-flex justify-content-center align-items-center justify-content-sm-center align-items-sm-center justify-content-md-center align-items-md-center justify-content-lg-center align-items-lg-center justify-content-xl-center align-items-xl-center justify-content-xxl-center align-items-xxl-center" aria-expanded="false" data-bs-toggle="dropdown" data-bs-auto-close="outside" id="genre-toggle" href="#" style="color: white;padding: 0.65rem;background: var(--bs-primary-text-emphasis);border-width: 2px;border-color: var(--bs-primary-text-emphasis);border-radius: 20px;margin-bottom: 0px;padding-bottom: 15px;padding-top: 15px;width: 46px;height: 46px;"><span class="d-flex align-items-xxl-center"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-filter-circle" style="font-size: 25px;">
                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"></path>
                                        <path d="M7 11.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5"></path>
                                    </svg></span></a>
                            <div class="dropdown-menu" style="background: var(--bs-emphasis-color);width: 500px;border: 2px solid var(--bs-primary-text-emphasis) ;">
                                <h6 class="dropdown-header"><strong>GENRE</strong></h6>
                                <div class="dropdown-divider" style="width: 90%;margin: auto;"></div>
                                <div class="container">
                                    <div class="row" style="margin: auto;">
                                        <!-- Start: Fictional? -->
                                        <div class="col-3 text-end">
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?fiction=Yes">Fiction</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?fiction=No">Non-Fiction</a></div>
                                            </div>
                                        </div><!-- End: Fictional? -->
                                        <!-- Start: Vertical Rule -->
                                        <div class="col-auto">
                                            <div class="vr" style="height: 100%;"></div>
                                        </div><!-- End: Vertical Rule -->
                                        <!-- Start: Genres -->
                                        <div class="col-4">
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Action%2FAdventure">Action/Adventure</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Biography">Biographies</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Children's">Children's</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Classics">Classics</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Contemporary">Contemporary</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Fantasy">Fantasy</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Food%20and%20Drink">Food and Drink</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Graphic%20Novels">Graphic Novels</a></div>
                                            </div>
                                        </div><!-- End: Genres -->
                                        <!-- Start: Genres2 -->
                                        <div class="col-4">
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Horror">Horror</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Memoir">Memoirs</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Mystery">Mystery</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Romance">Romance</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Science%20Fiction">Science Fiction</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Self%20Help">Self Help</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=Textbook">Textbooks</a></div>
                                            </div>
                                            <div class="row">
                                                <div class="col"><a href="product-list.html?genre=True%20Crime">True Crime</a></div>
                                            </div>
                                        </div><!-- End: Genres2 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">
                        <form id="search-input-form" style="margin-left: 0px;" onsubmit="handleSubmit(event)"><input class="form-control" type="search" id="uInput" placeholder="Search by title, author, ISBN..." style="border-radius: 15px;border-top-right-radius: 20px;border-bottom-right-radius: 20px;margin: 0.5rem;border-width: 2px;border-color: var(--bs-primary-text-emphasis);border-top-left-radius: 20px;border-bottom-left-radius: 20px;background: var(--bs-emphasis-color);" name="uInput"><!-- Start: User Search --><div><script>
    function handleSubmit(event) {
        event.preventDefault();
            let uInput = document.getElementById('uInput').value;
            localStorage.setItem('uInput', uInput);
            
            window.location.href = 'product-list.html?uInput=' + uInput;
            // fetch(url)
            //     .then(response => response.json())
            //     .then(data => {
            //         localStorage.setItem('apiData', JSON.stringify(data));
            //         window.location.href = 'product-list.html'; // replace with your next page URL
            //     });
    }
    function handleGenreClick() {
        
    }
</script></div><!-- End: User Search -->
                        </form>
                    </li>
                </ul>
                <div class="dropdown d-flex flex-shrink-0" style="position: relative;margin: 0.5rem;background: #7C83BC;border-radius: 25px;border-style: solid;border-color: #7C83BC;margin-right: 70px;"><a aria-expanded="false" data-bs-toggle="dropdown" data-bs-auto-close="outside" id="profile-toggle" href="#" style="color: white;padding: 0.65rem;background: var(--bs-primary-text-emphasis);border-width: 2px;border-color: var(--bs-primary-text-emphasis);border-radius: 20px;margin-left: 0px;">Profile&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-person-circle">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"></path>
                        </svg></a>
                    <div class="dropdown-menu" style="background: var(--bs-primary-bg-subtle);"><a class="dropdown-item" id="home-user-1" href="https://beesbooks.auth.us-east-1.amazoncognito.com/oauth2/authorize?client_id=6fn54hfl5sql09gnvtsvcerg7n&amp;response_type=code&amp;scope=email+openid+phone&amp;redirect_uri=https%3A%2F%2Fmain.dva0ia48yehl5.amplifyapp.com%2F">Sign Up/Login</a><a class="dropdown-item" id="home-bookmarks-1" href="bookmarks.html">Bookmarks</a><a class="dropdown-item" id="home-cart-1" href="shopping-cart.html"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-cart4 focus-ring ms-auto" style="width: 35px;height: 35px;transform: scaleX(-1);padding-left: 0px;color: #432E36;position: static;" href="shopping-cart.html">
                                <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5M3.14 5l.5 2H5V5zM6 5v2h2V5zm3 0v2h2V5zm3 0v2h1.36l.5-2zm1.11 3H12v2h.61zM11 8H9v2h2zM8 8H6v2h2zM5 8H3.89l.5 2H5zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0m9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0"></path>
                            </svg></a><a class="dropdown-item" id="logout-link" style="display:none;" href="#" onclick="logoutClicked()">Logout</a><a class="dropdown-item" id="admin-link" style="display:none;" href="https://main.dva0ia48yehl5.amplifyapp.com/admindashboard.html">Admin Dashboard</a></div>
                </div>
            </div>
        </div>
    </nav><!-- End: Navbar Centered Links -->
    <div class="modal fade" role="dialog" tabindex="-1" id="rating-modal" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header" style="background:var(--bs-primary-bg-subtle);">
                    <h4 class="modal-title" style="color:var(--bs-link-hover-color);font-weight:bold;">Leave a Rating</h4><button class="btn-close" aria-label="Close" data-bs-dismiss="modal" id="close-rating" type="button"></button>
                </div>
                <div class="modal-body" style="color:var(--bs-primary-bg-subtle);background:var(--bs-primary-bg-subtle);">
                    <div class="container justify-content-between align-items-center star-container" id="star-container" style="background:var(--bs-primary-bg-subtle);display:flex;"><i class="icon ion-android-star-outline" style="font-size:80px;color:var(--bs-success-text-emphasis);border-color:var(--bs-primary);"></i><i class="icon ion-android-star-outline" style="font-size:80px;color:var(--bs-success-text-emphasis);"></i><i class="icon ion-android-star-outline" style="font-size:80px;color:var(--bs-success-text-emphasis);"></i><i class="icon ion-android-star-outline" style="font-size:80px;color:var(--bs-success-text-emphasis);"></i><i class="icon ion-android-star-outline" style="font-size:80px;color:var(--bs-success-text-emphasis);"></i><script>
// script.js
document.addEventListener('DOMContentLoaded', function() {
    
    const stars = document.querySelectorAll('.star-container i');
    let clicked = false;
    let selected = 0;
    
    
    stars.forEach((star, index) => {
        //Responds to mousing over a star
        star.addEventListener('mouseover', function() {
            clicked = false;
            selected = 0;
            for (let i = 0; i <= 4; i++) {
                stars[i].classList.add('ion-android-star-outline');
            }
            for (let i = 0; i <= index; i++) {
                stars[i].classList.replace('ion-android-star-outline', 'ion-android-star');
            }
        });
          
        //Responds to removing a mouse from a star, before and after a click
        star.addEventListener('mouseout', function() {
            if(!clicked){
               for (let i = 0; i <= index; i++) {
                   stars[i].classList.replace('ion-android-star', 'ion-android-star-outline');
                }                
            }
        });   
       
        //Responds to maintaining filled stars after clicking a rating, saves result into 'selected'
        star.addEventListener('click', function() {
            console.log("clicked");
            selected = index + 1;
            console.log(selected);
            clicked = true;
            console.log(clicked);
        });
    });
    
    //Handles the exit button, will clear the star fields from the previous function if user decided to not submit
    const exit = document.getElementById("close-rating");
    exit.addEventListener('click', function(){            
        stars.forEach((star, index) => {

            for (let i = 0; i <= index; i++) {
                stars[i].classList.replace('ion-android-star', 'ion-android-star-outline');
            }
        });   
    });
    
    //Handles the submit button. Will tell the user they have to sign in to leave a rating if they are not registered. If a user is registered they will have confirmation their rating was saved. If a registered user is changing their rating, the previous rating will come up and allow them to change.
    const submit = document.getElementById("send-rating");
    submit.addEventListener('click', function(){
        
        const user = getValueFromJWT('access_token', 'username');
        //console.log(user);
        
        //const user = null;
        // const user = "tdchitwood";
        
        if(user == null){
            window.location.href = "https://beesbooks.auth.us-east-1.amazoncognito.com/oauth2/authorize?client_id=6fn54hfl5sql09gnvtsvcerg7n&response_type=code&scope=email+openid+phone&redirect_uri=https%3A%2F%2Fmain.dva0ia48yehl5.amplifyapp.com%2F";
        }else{
            let body = "";
            console.log("submit");
            if(selected == 0){
                alert("Please select a star to leave a rating.");
            }else{
                const productUrl = localStorage.getItem('productURL');
                fetch(productUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('HTTP error! Status: ${response.status}');
                    }
                    return response.json();
                })
                .then(data => {
                    let ratebody = {
                        "isbnpk": data["Items"][0]["SK"].slice(5),
                        "usersk": user,
                        "rate": selected,
                        "genre": data["Items"][0]["PK"].slice(6)
                      };
                    body = JSON.stringify(ratebody);
                    console.log("Body: " + body);
                    const apiUrl = 'https://psiceqjjgb.execute-api.us-east-1.amazonaws.com/BB_prod/ProductManagement';
                    console.log(apiUrl);
                    console.log("body x2: " + body);
                    fetch(apiUrl, {
                        method: 'PUT',
                        body: body,
                    })
                    .then(response => {
                        if (response.ok) {
                            return response.json();
                        } else {
                            throw new Error(`Error: ${response.status} ${response.statusText}`);
                        }
                    })
                    .then(data => {
                        console.log('Response data:', data);
                    })
                    .catch(error => {
                        console.error(error);
                    });
                    })
                    .catch(error => {
                        console.error('Fetch error:', error);
                });        
            }
        }
        
    });    
});

</script></div>
                </div>
                <div class="modal-footer" style="background:var(--bs-primary-bg-subtle);"><button class="btn btn-primary" data-bs-dismiss="modal" id="send-rating" type="button">Submit</button></div>
            </div>
        </div>
    </div>
    <div class="container" style="margin-top:1.5rem;margin-bottom:1.5rem;">
        <div class="card" style="width:auto;height:auto;">
            <div class="card-body">
                <div class="row text-center text-sm-center text-md-start text-lg-start text-xl-start text-xxl-start justify-content-center justify-content-sm-center justify-content-md-start justify-content-lg-start justify-content-xl-start justify-content-xxl-start" style="margin:2rem;">
                    <div class="col-md-4 align-self-center"><img class="img-fluid" id="book-image" src="assets/img/placeholder-book.gif" alt="Book Image">
                        <p class="d-md-flex justify-content-md-center" id="add-book-rating" data-bs-toggle="modal" data-bs-target="#rating-modal" style="margin:10px;font-size:20px;color:rgb(154,154,154);"><span style="text-decoration:underline;">Click to Add Rating</span></p>
                    </div>
                    <div class="col-md-8">
                        <h2 id="book-title">Book Title</h2>
                        <p class="text-muted" id="book-author"><strong>by&nbsp;</strong></p>
                        <p id="book-genre"><strong>Genre:&nbsp;</strong></p>
                        <p id="book-description"><strong>Description:&nbsp;</strong></p>
                        <p id="book-rating"><strong>Rating:&nbsp;</strong></p>
                        <p id="book-price"><strong>Price:&nbsp;</strong></p>
                        <div class="row">
                            <div class="col"><button class="btn btn-primary btn-lg" id="product-to-cart" style="margin-right:0px;font-size:12.7px;width:154.6px;height:44.4px;font-weight:bold;color:#ffffff;" onclick="addProductToCart()">Add to Cart</button><button class="btn btn-primary" id="product-for-later" style="font-size:12.7px;width:154.6px;height:44.4px;font-weight:bold;color:#ffffff;margin-left:1rem;">Save for Later</button></div>
                        </div>
                        <div id="product-alert-placeholder" style="margin: 1rem;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div><script>
        let bookIsbn = "";
        window.onload = function() {
            const apiUrl = localStorage.getItem('productURL');
            console.log(apiUrl);
            fetch(apiUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error('HTTP error! Status: ${response.status}');
                }
                return response.json();
            })
            .then(data => {
                console.log(data);
                //const bookIsbn = data["Items"][0]["SK"];
                bookIsbn = data["Items"][0]["SK"];
                console.log(bookIsbn);
                document.getElementById('book-title').textContent =
                    data["Items"][0]["title"];
                console.log(data["Items"][0]["title"]);
                document.getElementById('book-author').textContent +=
                    data["Items"][0]["author"];
                document.getElementById('book-description').textContent +=
                    data["Items"][0]["description"];
                document.getElementById('book-genre').textContent +=
                    data["Items"][0]["PK"].slice(6);
                document.getElementById('book-price').textContent += " $" +
                    data["Items"][0]["price"];
                if (data["Items"][0]["rating"] != 0.0) {
                    document.getElementById('book-rating').textContent +=
                    data["Items"][0]["rating"];
                }
                else {
                    document.getElementById('book-rating').textContent = "No ratings.";
                }
                document.getElementById('book-image').src =
                   data["Items"][0]["img"];
                //console.log(JSON.parse(data["Item"]["reviews"])[1])
                // document.getElementById('book-review-two').textContent =
                //     JSON.parse(data["Item"]["reviews"])[1];
                // document.getElementById('book-review-three').textContent =
                //     data["Item"]["reviews"][2];
                // document.getElementById("product-for-later").onclick = function(){
                //     console.log("clicked");
                //     const isbn = bookIsbn.substring(5);
                //     checkAndAddFavorite(isbn);
                // }
            })
            .catch(error => {
                console.error('Fetch error:', error);
            });
        };
        document.getElementById("product-for-later").onclick = function(){
                    console.log("clicked");
                    const isbn = bookIsbn.substring(5);
                    checkAndAddFavorite(isbn);
                }
    //checks if the book is already in the user's favorites; prevents duplicates
    function checkAndAddFavorite(bookIsbn){
        const user = getValueFromJWT('access_token', 'username');
        if(user == null){
            window.location.href = "https://beesbooks.auth.us-east-1.amazoncognito.com/oauth2/authorize?client_id=6fn54hfl5sql09gnvtsvcerg7n&response_type=code&scope=email+openid+phone&redirect_uri=https%3A%2F%2Fmain.dva0ia48yehl5.amplifyapp.com%2F";
        }
        const endpoint = 'https://psiceqjjgb.execute-api.us-east-1.amazonaws.com/BB_prod/userFavorites?username=' + user;
        // Fetch user's favorites
        fetch(endpoint)
        .then(response => {
            if(!response.ok){
                throw new Error('Network Error');
            }
            // Parse response as JSON and return it
            return response.json();
        })
        .then(userFavorites => {
            console.log(userFavorites);
            let found = false; // Variable to track if the book is found in favorites
            for (let i = 0; i < userFavorites.favorites.length; i++) {
                console.log(userFavorites.favorites[i].SK.substring(5));
                if (userFavorites.favorites[i].SK.substring(5) === bookIsbn) {
                    console.log("Book is already in favorites.");
                    spawnAlert('product-alert-placeholder','Book is already in your favorites.','primary');
                    found = true; // Set found to true if the book is found in favorites
                    break;
                }
            }
            if (!found) { // If the book is not found in favorites, add it
                console.log("New favorite");
                spawnAlert('product-alert-placeholder','Added to favorites!','primary');
                addFavorite(bookIsbn);
            }
        })
        .catch(error => {
            // Handle fetch errors
            console.log('Error fetching user favorites', error);
        });
    }
        function addFavorite(bookIsbn){
            const endpoint = 'https://oevgdgxf8f.execute-api.us-east-1.amazonaws.com/beta/user/favorites';
            const user = getValueFromJWT('access_token', 'username');
            if(user == null){
                window.location.href = "https://beesbooks.auth.us-east-1.amazoncognito.com/oauth2/authorize?client_id=6fn54hfl5sql09gnvtsvcerg7n&response_type=code&scope=email+openid+phone&redirect_uri=https%3A%2F%2Fmain.dva0ia48yehl5.amplifyapp.com%2F";
            }
            const data = {
                username: user,
                favorites: [bookIsbn]
            }
        //configure fetch options
        const fetchOptions = {
            method: 'POST',
            headers: {
                'Content-Type' : 'application/json'
            },
            body: JSON.stringify(data)
        };
        //make fetch request to addFavorite lambda endpoint
        fetch(endpoint, fetchOptions)
            .then(response => {
            if(!response.ok){
                throw new Error('Network Error');
            }
            //parse response as JSON and return it
            return response.json();
        })
        .then(responseData => {
            //handle response from lambda function
            console.log('Favorites updated successfully', responseData);
            //showNotification("Favorite has been added!")
        })
        .catch(error => {
            //handle fetch errors
            console.log('Error adding favorite', error);
        })
    }
    function showNotification(message) {
        const notification = document.createElement('div');
        notification.classList.add('notification');
        notification.textContent = message;
        document.body.appendChild(notification);
        setTimeout(() => {
            notification.remove();
        }, 3000); // Remove the notification after 3 seconds
        location.reload();
}
        
    </script></div>
    <footer id="bb-footer" class="bg-primary-gradient">
        <div class="container py-4 py-lg-5">
            <div class="row justify-content-center">
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">About</h3>
                    <ul class="list-unstyled">
                        <li><a id="cloud-chasers-home" href="https://main.d140ix98ckyp1w.amplifyapp.com/">Cloud Chasers</a></li>
                        <li><a id="lata-home" href="https://adiazsoriano.github.io/ITEC471-Team2-Website/">LATA</a></li>
                        <li><a id="binary-bees-home" href="https://main.d2opax599kp7e1.amplifyapp.com/">Binary Bees</a></li>
                    </ul>
                </div>
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Orders</h3>
                    <ul class="list-unstyled">
                        <li><a id="order-tracking" href="#">Tracking</a></li>
                        <li><a id="order-status" href="#">Status</a></li>
                        <li><a id="order-history" href="#">History</a></li>
                    </ul>
                </div>
                <div class="col-sm-4 col-md-3 text-center text-lg-start d-flex flex-column">
                    <h3 class="fs-6 fw-bold">Customer Support</h3>
                    <ul class="list-unstyled">
                        <li><a id="footer-contact-link" href="contact.html">Contact Us</a></li>
                        <li><a id="footer-support-forum" href="#">Support Forum</a></li>
                        <li><a id="footer-refunds" href="#">Refunds/Exchanges</a></li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="text-muted d-flex justify-content-between align-items-center pt-3">
                <p class="mb-0">Copyright © 2023 Bee's Books</p><span class="shadow d-flex justify-content-center align-items-center bs-icon-sm bs-icon-circle bs-icon-primary me-2 bs-icon" style="width:40px;height:40px;background:#7C83BC;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewbox="0 0 24 24" fill="none" style="width:25px;height:25px;"><path fill-rule="evenodd" d="M17.9513 15.571C17.7695 17.2187 16.9205 18.6654 15.6805 19.635C15.332 20.4692 14.7092 21.1601 13.9247 21.5951C13.7025 22.4574 12.9196 23.0944 11.9879 23.0944C11.0562 23.0944 10.2733 22.4574 10.0511 21.5951C9.26672 21.1602 8.64392 20.4693 8.29547 19.6353C7.05955 18.6691 6.21203 17.229 6.02621 15.5883C4.93527 16.4161 3.37955 16.4118 2.28618 15.4944C1.01696 14.4294 0.851409 12.5371 1.91641 11.2679L6.00966 6.38975C6.27125 3.31753 8.84785 0.905579 11.9878 0.905579C15.1166 0.905579 17.6861 3.30046 17.9631 6.35711L22.0837 11.2679C23.1487 12.5371 22.9831 14.4294 21.7139 15.4944C20.613 16.4182 19.0433 16.4161 17.9513 15.571ZM15.6254 12.9056L13.9472 10.9056H10.0529L8.37467 12.9056H15.6254ZM17.9878 12.6095L19.0195 13.839C19.3745 14.2621 20.0053 14.3173 20.4283 13.9623C20.8514 13.6073 20.9066 12.9765 20.5516 12.5535L17.9878 9.49803V12.6095ZM15.9878 8.90558V6.90558C15.9878 4.69644 14.1969 2.90558 11.9878 2.90558C9.77865 2.90558 7.98779 4.69644 7.98779 6.90558V8.90558H15.9878ZM4.98059 13.839L5.98779 12.6387V9.52726L3.4485 12.5535C3.0935 12.9765 3.14869 13.6073 3.57176 13.9623C3.99483 14.3173 4.62559 14.2621 4.98059 13.839ZM11.9878 18.9056C9.77865 18.9056 7.98779 17.1147 7.98779 14.9056H15.9878C15.9878 17.1147 14.1969 18.9056 11.9878 18.9056Z" fill="currentColor"></path></svg></span>
            </div>
        </div><button id="back-to-top" class="back-to-top" style="background:var(--bs-primary);"><i class="fas fa-chevron-up"></i></button>
    </footer>
    <div class="modal fade visible" role="dialog" tabindex="-1" id="cart-modal" style="height:400px;">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-bottom-style:none;height:20px;"><button class="btn-close btn-close-white" aria-label="Close" data-bs-dismiss="modal" style="color:var(--bs-emphasis-color);width:5px;height:5px;" type="button"></button></div>
                <div class="modal-body text-center" style="border-style:none;height:auto;padding:0px;padding-top:0px;padding-right:0px;">
                    <p style="color:var(--bs-emphasis-color);margin-bottom:0px;padding-bottom:0px;padding-top:0px;">Successfully added to Shopping Cart</p>
                </div>
                <div class="modal-footer d-sm-flex justify-content-center align-items-sm-center" style="border-top-style:none;border-bottom-style:none;border-bottom-color:var(--bs-emphasis-color);height:50px;margin-bottom:10px;margin-top:10px;"><button class="btn btn-light btn-sm text-center d-sm-flex justify-content-sm-center align-items-sm-center" data-bs-dismiss="modal" style="width:75px;" type="button">OK</button></div>
            </div>
        </div>
    </div>
    <div class="modal fade visible" role="dialog" tabindex="-1" id="duplicate-bookmark-modal" style="height:400px;">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-bottom-style:none;height:20px;"><button class="btn-close btn-close-white" aria-label="Close" data-bs-dismiss="modal" style="color:var(--bs-emphasis-color);width:5px;height:5px;" type="button"></button></div>
                <div class="modal-body text-center" style="border-style:none;height:auto;padding:0px;padding-top:0px;padding-right:0px;">
                    <p style="color:var(--bs-emphasis-color);margin-bottom:0px;padding-bottom:0px;padding-top:0px;">Product already exists in Bookmarks</p>
                </div>
                <div class="modal-footer d-sm-flex justify-content-center align-items-sm-center" style="border-top-style:none;border-bottom-style:none;border-bottom-color:var(--bs-emphasis-color);height:50px;margin-bottom:10px;margin-top:10px;"><button class="btn btn-light btn-sm text-center d-sm-flex justify-content-sm-center align-items-sm-center" data-bs-dismiss="modal" style="width:75px;" type="button">OK</button></div>
            </div>
        </div>
    </div>
    <div class="modal fade visible" role="dialog" tabindex="-1" id="bookmark-modal" style="height:400px;">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header" style="border-bottom-style:none;height:20px;"><button class="btn-close btn-close-white" aria-label="Close" data-bs-dismiss="modal" style="color:var(--bs-emphasis-color);width:5px;height:5px;" type="button"></button></div>
                <div class="modal-body text-center" style="border-style:none;height:auto;padding:0px;padding-top:0px;padding-right:0px;">
                    <p style="color:var(--bs-emphasis-color);margin-bottom:0px;padding-bottom:0px;padding-top:0px;">Successfully added to Bookmarks</p>
                </div>
                <div class="modal-footer d-sm-flex justify-content-center align-items-sm-center" style="border-top-style:none;border-bottom-style:none;border-bottom-color:var(--bs-emphasis-color);height:50px;margin-bottom:10px;margin-top:10px;"><button class="btn btn-light btn-sm text-center d-sm-flex justify-content-sm-center align-items-sm-center" data-bs-dismiss="modal" style="width:75px;" type="button">OK</button></div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/bold-and-bright.js"></script>
    <script src="assets/js/cookie.js"></script>
    <script src="https://cdn.datatables.net/v/bs5/dt-1.13.8/b-2.4.2/datatables.min.js"></script>
    <script src="assets/js/modalStopper.js"></script>
    <script src="assets/js/productTable.js"></script>
    <script src="assets/js/usertable.js"></script>
    <script src="assets/js/productPageIntegration.js"></script>
    <script src="assets/js/viewProductModal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script src="assets/js/Alerts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>

</html>